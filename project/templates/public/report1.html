<!-- templates/public/report.html -->
<!-- Displays the detailed quality report to the consumer. -->
{% extends "base.html" %}
{% block title %}Quality Report - {{ report.batch_code }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto bg-white p-6 sm:p-8 rounded-xl shadow-lg">
    
    <!-- Report Header -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center pb-4 border-b border-gray-200">
        <div>
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Certificate of Analysis</h1>
            <p class="text-gray-500 mt-1">Batch Wise â€“ Test Report</p>
        </div>
        <img src="{{ url_for('static', filename='heritage-logo.png') }}" 
     alt="Heritage Foods Logo" 
     class="h-27 w-32 mt-15 sm:mt-0">
    </div>

    <!-- Product Details -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-4 my-6 text-sm text-gray-700">
        <div><strong class="block font-semibold text-gray-800">Product Name:</strong> {{ report.product.name }}</div>
        <div><strong class="block font-semibold text-gray-800">Unit:</strong> {{ report.plant_name }}</div>
        <div><strong class="block font-semibold text-gray-800">Batch No.:</strong> {{ report.batch_code }}</div>
        <div><strong class="block font-semibold text-gray-800">Use by date:</strong> {{ report.expiry_date.strftime('%d.%m.%Y') }}</div>
    </div>

    <!-- Results Table -->
    <div class="overflow-x-auto border-t border-gray-200 pt-4">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">S.No</th>
                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Parameters</th>
                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Specifications</th>
                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Results</th>
                    <th class="px-4 py-2 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Methods</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for result in results %}
                <tr class="text-sm">
                    <td class="px-4 py-3 text-gray-500">{{ loop.index }}</td>
                    <td class="px-4 py-3 text-gray-800 font-medium">{{ result.template.parameter }}</td>
                    <td class="px-4 py-3 text-gray-500">{{ result.template.specification }}</td>
                    <td class="px-4 py-3 font-semibold text-gray-900">{{ result.result_value }}</td>
                    <td class="px-4 py-3 text-gray-500">{{ result.template.method }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Signature -->
    <div class="mt-12 text-right">
        {% if report.creator and report.creator.signature_filename %}
        <img src="{{ url_for('main.uploaded_file', filename=report.creator.signature_filename) }}" alt="QA Signature" class="w-32 ml-auto">
        {% endif %}
        <p class="text-md font-semibold mt-2">Plant QA Incharge</p>
        <p class="text-sm text-gray-500">Heritage Foods Limited</p>
    </div>
</div>

<!-- Action Buttons -->
<div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
    <a href="{{ url_for('main.index') }}" class="w-full sm:w-auto bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 transition-all shadow-md text-center">
        Search Another
    </a>
    <a href="{{ url_for('main.download_pdf_report', report_id=report.id) }}" target="_blank" class="w-full sm:w-auto bg-heritage-green text-white font-bold py-3 px-6 rounded-lg hover:bg-heritage-green-dark transition-all shadow-md text-center">
        Download PDF
    </a>
</div>
{% endblock %}