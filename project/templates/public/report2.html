{% extends "base.html" %}
{% block title %}Quality Report - {{ report.batch_code }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto py-8 relative">

    <!-- <div class="absolute top-0 left-0 z-10 -mt-8 -ml-8 w-24 sm:w-32 lg:w-40 opacity-75">
        <img src="{{ url_for('static', filename='doctor cow image.png') }}"
             alt="Doctor Cow"
             class="w-full h-auto">
    </div>

    <div class="absolute top-0 right-0 z-10 w-48 sm:w-60 lg:w-72">
        <div class="relative w-full overflow-hidden" style="padding-bottom: 50%;">
            <img src="{{ url_for('static', filename='images/image_80a8a2.png') }}"
                 alt="Cow holding report"
                 class="absolute top-0 left-0 w-full h-auto transform -translate-y-1/2">
        </div>
    </div> -->

    <div class="relative z-20 bg-white p-6 sm:p-10 rounded-3xl shadow-2xl border border-gray-200">
        
        <div class="flex flex-col sm:flex-row justify-between items-center mb-8">
            <img src="{{ url_for('static', filename='heritage-logo.png') }}"
                 alt="Heritage Foods Logo"
                 class="h-16 w-16 sm:h-20 sm:w-20 mb-4 sm:mb-0">
            <div class="text-center sm:text-right">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 tracking-tight">CERTIFICATE OF ANALYSIS</h1>
                <p class="text-gray-500 mt-1 text-base sm:text-lg font-semibold">BATCH WISE â€“ TEST REPORT</p>
            </div>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-4 text-sm text-gray-700 bg-gray-50 p-6 rounded-xl border border-gray-200 mb-8 shadow-sm">
            <div>
                <strong class="block font-bold text-gray-800">Product:</strong>
                <span class="mt-1 block">{{ report.product.name }}</span>
            </div>
            <div>
                <strong class="block font-bold text-gray-800">Unit:</strong>
                <span class="mt-1 block">{{ report.plant_name }}</span>
            </div>
            <div>
                <strong class="block font-bold text-gray-800">Batch No:</strong>
                <span class="mt-1 block">{{ report.batch_code }}</span>
            </div>
            <div>
                <strong class="block font-bold text-gray-800">Use by date:</strong>
                <span class="mt-1 block">{{ report.expiry_date.strftime('%d.%m.%Y') }}</span>
            </div>
        </div>

        <div class="hidden sm:block overflow-x-auto border border-gray-200 rounded-2xl shadow-lg">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">S.No</th>
                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Parameters</th>
                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Specifications</th>
                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Results</th>
                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Methods</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for result in results %}
                    <tr class="text-sm hover:bg-gray-50 transition-colors duration-150 align-top">
                        <td class="px-6 py-4 text-gray-500">{{ loop.index }}</td>
                        <td class="px-6 py-4 text-gray-800 font-medium">{{ result.template.parameter }}</td>
                        <td class="px-6 py-4 text-gray-500">{{ result.template.specification }}</td>
                        <td class="px-6 py-4 font-semibold text-gray-900">{{ result.result_value }}</td>
                        <td class="px-6 py-4 text-gray-500">{{ result.template.method }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="sm:hidden space-y-6">
            {% for result in results %}
            <div class="bg-white border border-gray-200 rounded-xl p-6 shadow-md">
                <div class="flex justify-between items-start mb-4">
                    <strong class="text-lg font-bold text-gray-800">{{ result.template.parameter }}</strong>
                    <span class="text-2xl font-extrabold text-heritage-green">{{ result.result_value }}</span>
                </div>
                <div class="space-y-3 text-sm text-gray-700">
                    <p>
                        <strong class="block text-gray-500 font-semibold">Specifications:</strong>
                        {{ result.template.specification }}
                    </p>
                    <p>
                        <strong class="block text-gray-500 font-semibold">Method:</strong>
                        {{ result.template.method }}
                    </p>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="mt-12 text-center sm:text-right">
            {% if report.creator and report.creator.signature_filename %}
            <div class="inline-block p-4 border border-gray-300 rounded-lg shadow-inner bg-white">
                    <img src="{{ url_for('main.uploaded_file', filename=report.creator.signature_filename) }}"
                    alt="QA Signature"
                    class="w-40 h-auto mx-auto sm:ml-auto">
            </div>
            {% endif %}
            <p class="text-md font-semibold mt-4">Plant QA Incharge</p>
            <p class="text-sm text-gray-500">Heritage Foods Limited</p>
        </div>
    </div>
</div>

<div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
    <a href="{{ url_for('main.index') }}" class="w-full sm:w-auto bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 transition-all shadow-md text-center">
        Search Another
    </a>
    <a href="{{ url_for('main.download_pdf_report', report_id=report.id) }}" target="_blank" class="w-full sm:w-auto bg-heritage-green text-white font-bold py-3 px-6 rounded-lg hover:bg-heritage-green-dark transition-all shadow-md text-center">
        Download PDF
    </a>
</div>
{% endblock %}